<h2>Formulario Metter</h2>
<%- if params[:edit]%>
	<%= form_for :canino_characteristic, :html => {:id => 'canino_characteristic_form'} do |f| %>
	<%= f.collection_select :value, @canine_characteristic, :id, :temporal_canine_name, {prompt: "Selecciona Canino"}, {class: "form-control find_selected"}%>
	<% end %>
	<button id="button_canino_characteristic">Adicionar Metter</button>  
	<script type="text/javascript">
		$(document).ready(function() {
			var characteristic_id;
			var canine_id = <%= params[:canine_id]%>;
			$("#button_canino_characteristic").click(function(){
				$('#canino_characteristic_form').find('.find_selected').each(function(){
					if($("option:selected", this).attr("value") != "" ){
						characteristic_id =  $(this).val();
					}
				})	
				$.ajax({
					type: "PUT",
					url: "/admin/canino_characteristics/" + characteristic_id + "/update_metter",
					data: { canine_id},
				})
			});
		});
	</script>	
<%else%>
	<%= form_for :canino_characteristic, :html => {:id => 'canino_characteristic_form'} do |f| %>
		<div class="row">
			<%- if params[:canine_id] == "0"%>
				<div class="col-md-12">
					<%= f.label :temporal_canine_name, "Nombre Ejemplar"%>
					<%= f.text_field :value, :class => "form-control"%>
				</div>
			<%end%>
			<%- @characteristics.each do |characteristic|%>
				<div class="col-md-6">
					<span class="bold"> <%= characteristic.name%> </span>
					<%= f.hidden_field :characteristic_id, :value => characteristic.id %>
					<%- if characteristic.measure_id.blank? %>
						<%= f.collection_select :value, characteristic.characteristic_details, :id, :description, {prompt: "Escoger"}, {class: "form-control find_selected"}%>
					<%else%>
						<%= f.text_field :value, :class => "form-control text_fieldn find_selected"%>
					<%end%>
				</div>
			<%end%>
			<br>
		</div>
	<% end %>
	<br>
	<button id="button_canino_characteristic" class="btn btn-primary btn-block">Crea Metter</button>  	
	<script type="text/javascript">
		$(document).ready(function() {
			var characteristics = {};
			$("#button_canino_characteristic").click(function(){
				var canine;
				var canine_id;
				if ($('#canino_characteristic_value').val()) {
					canine = $('#canino_characteristic_value').val();
					canine_id = <%= params[:canine_id]%>;
				} else{
					canine_id = <%= params[:canine_id]%>;
				};		
				$('#canino_characteristic_form').find('.find_selected').each(function(){
					if($("option:selected", this).attr("value") != "" ){
						console.log($(this).val());
						characteristics[$(this).prev().val()] = $(this).val();
					}
				})
				$.ajax({
					type: "POST",
					url: "/admin/canino_characteristics",
					data: {  characteristics, canine, canine_id},
				})
			});
		});
	</script>
<%end%>